(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     65646,       1734]
NotebookOptionsPosition[     61746,       1630]
NotebookOutlinePosition[     62142,       1647]
CellTagsIndexPosition[     62099,       1644]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
This file reproduces data in Figure 3, Supplementary Figures 1-11, and \
Supplementary Table 1\
\>", "Title",
 CellChangeTimes->{{3.7591781446027107`*^9, 3.7591781639546957`*^9}, {
   3.7592578570022593`*^9, 3.7592578588478513`*^9}, {3.759257942568548*^9, 
   3.7592579514634657`*^9}, {3.759257985413433*^9, 3.759257992710212*^9}, {
   3.767468188903812*^9, 3.767468225181879*^9}, {3.767468427371224*^9, 
   3.767468435582177*^9}, 
   3.7674688249597425`*^9},ExpressionUUID->"3f5bbd5b-b8c3-4282-9f4e-\
cdbe883e1d21"],

Cell[CellGroupData[{

Cell["Importing the dataset ", "Section",
 CellChangeTimes->{{3.7366252953427553`*^9, 3.7366253029702415`*^9}, {
   3.7385851114895573`*^9, 3.7385851159275494`*^9}, {3.7591777948818874`*^9, 
   3.759177802262917*^9}, 
   3.759179775013978*^9},ExpressionUUID->"4965ea07-7681-400f-9379-\
19a57f510140"],

Cell[CellGroupData[{

Cell["Setting the directory", "Subsection",
 CellChangeTimes->{{3.7591725870476537`*^9, 3.759172595718913*^9}, {
  3.759175582064991*^9, 
  3.759175582671501*^9}},ExpressionUUID->"d371701f-e533-4ebd-b7ab-\
85f7e6e570ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7366253084061537`*^9, 3.7366253454245605`*^9}, {
   3.736625420829594*^9, 3.736625437013482*^9}, 3.74439177364746*^9, {
   3.7576530945887585`*^9, 3.7576531254120965`*^9}, 3.7584812871047506`*^9, 
   3.7585755244989033`*^9, {3.7587316323608027`*^9, 3.7587316335040803`*^9}, 
   3.7591705552320523`*^9, {3.759178664647106*^9, 3.7591786669957843`*^9}, {
   3.7593096730333056`*^9, 3.7593097182373714`*^9}, {3.7593473112092514`*^9, 
   3.7593473126356797`*^9}},ExpressionUUID->"76445fae-9b9d-4c78-b061-\
9ff22683bbf7"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Time series from excel: BC is de-trended/de-seasonalized number of background \
checks from all the states, StateNames are the names of all the states, MS is \
the number of mass shootings, and MO is media output chosen to be related to \
firearm control.\
\>", "Subsection",
 CellChangeTimes->{{3.7382976265610943`*^9, 3.7382976634836564`*^9}, {
  3.7383927894106913`*^9, 3.7383927934108677`*^9}, {3.7384036332993526`*^9, 
  3.738403652903039*^9}, {3.738470771704258*^9, 3.738470820210782*^9}, {
  3.7587626163078012`*^9, 3.758762631000561*^9}, {3.7591755879174123`*^9, 
  3.7591756116014533`*^9}, {3.759177944141066*^9, 3.7591780978389287`*^9}, {
  3.759179806787484*^9, 
  3.759179858326359*^9}},ExpressionUUID->"c939f107-56f9-4597-94a4-\
72714d5088ef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dataORIGINAL", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<summary_data.xlsx\>\"", ",", "\"\<Data\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataORIGINALstate", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<background_checks_processed.xlsx\>\"", ",", "\"\<Data\>\""}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.738297669156565*^9, 3.738297676065214*^9}, {
   3.7382977072376194`*^9, 3.7382977128480687`*^9}, {3.7382977881975*^9, 
   3.7382977931864777`*^9}, 3.7382978252745633`*^9, {3.7383928050064793`*^9, 
   3.738392805352639*^9}, 3.7576531468422084`*^9, 3.757653190638726*^9, 
   3.757653225614194*^9, {3.7587600020652847`*^9, 3.758760004826716*^9}, {
   3.7587607393252163`*^9, 3.7587607629662805`*^9}, {3.758761187576422*^9, 
   3.7587611916550665`*^9}},ExpressionUUID->"f41f98e9-d6e0-4f4e-9646-\
fda4d5fa617a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"dataORIGINALstate", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "i", ",", "j"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dataORIGINALstate", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "51"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StateNames", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"dataORIGINALstate", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "j"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "2", ",", "51"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MS", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"dataORIGINAL", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "i", ",", "2"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dataORIGINAL", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MO", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"dataORIGINAL", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "i", ",", "3"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"dataORIGINAL", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7366256237496166`*^9, 3.7366257461685095`*^9}, {
   3.7382977270809507`*^9, 3.738297753497616*^9}, {3.7382977964561543`*^9, 
   3.738297803031521*^9}, {3.7382978418174515`*^9, 3.7382978465824428`*^9}, {
   3.7383928523325*^9, 3.738392888954846*^9}, {3.7383952192553287`*^9, 
   3.738395231332471*^9}, {3.7384040878014183`*^9, 3.7384041518231916`*^9}, 
   3.7576532515134373`*^9, {3.7576533130107737`*^9, 3.757653367464516*^9}, {
   3.7587600570940714`*^9, 3.7587601026428847`*^9}, 3.7587602229235854`*^9, 
   3.758760309080179*^9, {3.758760795442278*^9, 3.7587608663387365`*^9}, {
   3.7587611679293804`*^9, 3.75876117453465*^9}, 3.7587612118098726`*^9, {
   3.7587925851*^9, 3.758792638164*^9}, {3.7591797930905137`*^9, 
   3.7591797934317255`*^9}},ExpressionUUID->"f503e116-bb52-4603-99df-\
9a3acf3dcc94"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Conversion of time series to symbols, an X is used to refer to symbols\
\>", "Subsection",
 CellChangeTimes->{{3.7384716337524705`*^9, 3.7384716377091045`*^9}, 
   3.759179894970996*^9},ExpressionUUID->"5f0f4444-528b-483e-8aab-\
bd162813d19f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XBC", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"BC", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "j"}], "]"}], "]"}], "-", 
         RowBox[{"BC", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"k", "-", "1"}], ",", "j"}], "]"}], "]"}]}], ">", "0"}], 
       ",", "1", ",", "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "2", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XMS", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"MS", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ">", "0"}], ",", "1", ",", "0"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XMO", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MO", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "-", 
         RowBox[{"MO", "[", 
          RowBox[{"[", 
           RowBox[{"k", "-", "1"}], "]"}], "]"}]}], ">", "0"}], ",", "1", ",",
        "0"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "2", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nt", "=", 
   RowBox[{"Length", "[", "XMO", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7366260342524824`*^9, 3.736626049398036*^9}, {
  3.7366260926002536`*^9, 3.7366262228587885`*^9}, {3.7382971713335333`*^9, 
  3.738297185475576*^9}, {3.7385850205899706`*^9, 3.7385850341409936`*^9}, {
  3.7401552309831963`*^9, 3.7401552509966736`*^9}, {3.758761320316391*^9, 
  3.758761386814878*^9}, {3.7587616196395507`*^9, 3.7587616252964735`*^9}, {
  3.7587617579961185`*^9, 3.758761761986431*^9}, {3.7591799066087837`*^9, 
  3.759179914591068*^9}},ExpressionUUID->"1e276d92-8ae3-49b0-859a-\
397b93999c3f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Key modules for the analysis", "Section",
 CellChangeTimes->{{3.7591752899489894`*^9, 
  3.7591753011666803`*^9}},ExpressionUUID->"8621902e-017c-40f8-a2c0-\
c8c8503e8886"],

Cell[CellGroupData[{

Cell["\<\
Conditional transfer entropy on binary time series XSOURCE->XTARGET/XCOND: \
CondTE[XTARGET,XSOURCE,XCOND] \
\>", "Subsection",
 CellChangeTimes->{{3.7591706236581173`*^9, 3.7591706405626183`*^9}, {
  3.759170712673134*^9, 3.759170728840203*^9}, {3.7591708149030867`*^9, 
  3.7591708236688375`*^9}, {3.7591728791178074`*^9, 3.759172896227564*^9}, {
  3.7591738225576544`*^9, 3.7591738499766054`*^9}, {3.7591744763143177`*^9, 
  3.7591744765372972`*^9}, {3.759257963851817*^9, 
  3.7592579645366325`*^9}},ExpressionUUID->"5a15c344-7b56-436b-b89f-\
091ba4afdd48"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CondTE", "[", 
   RowBox[{"XTARGET_", ",", "XSOURCE_", ",", "XCOND_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "T", ",", "\[Epsilon]", ",", "X", ",", "Xt", ",", "XXt", ",", "XXXt", 
      ",", "Pxx00", ",", "Pxx01", ",", "Pxx10", ",", "Pxx11", ",", "hxx", ",",
       "Pxxx000", ",", "Pxxx001", ",", "Pxxx010", ",", "Pxxx100", ",", 
      "Pxxx011", ",", "Pxxx101", ",", "Pxxx110", ",", "Pxxx111", ",", "hxxx", 
      ",", "XpXXt", ",", "Pxpxx000", ",", "Pxpxx001", ",", "Pxpxx010", ",", 
      "Pxpxx100", ",", "Pxpxx011", ",", "Pxpxx101", ",", "Pxpxx110", ",", 
      "Pxpxx111", ",", "hxpxx", ",", "XpXXXt", ",", "Pxpxxx0000", ",", 
      "Pxpxxx0001", ",", "Pxpxxx0010", ",", "Pxpxxx0100", ",", "Pxpxxx1000", 
      ",", "Pxpxxx1001", ",", "Pxpxxx1100", ",", "Pxpxxx1110", ",", 
      "Pxpxxx1111", ",", "Pxpxxx0011", ",", "Pxpxxx0101", ",", "Pxpxxx0110", 
      ",", "Pxpxxx0111", ",", "Pxpxxx1010", ",", "Pxpxxx1011", ",", 
      "Pxpxxx1101", ",", "hxpxxx"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"T", "=", 
      RowBox[{"Length", "[", "XSOURCE", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Epsilon]", "=", 
      RowBox[{
       RowBox[{"10", "^", 
        RowBox[{"(", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"MantissaExponent", "[", 
            RowBox[{"T", "^", "4"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"XTARGET", "[", 
           RowBox[{"[", "t", "]"}], "]"}], ",", 
          RowBox[{"XSOURCE", "[", 
           RowBox[{"[", "t", "]"}], "]"}], ",", 
          RowBox[{"XCOND", "[", 
           RowBox[{"[", "t", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Xt", "=", 
      RowBox[{"Transpose", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XXt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "t"}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "t"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", 
          RowBox[{"T", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxx00", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxx01", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxx10", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxx11", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hxx", "=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxx00", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxx00", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxx00"}], "]"}]}], ",", "0"}], "]"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxx01", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxx01", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxx01"}], "]"}]}], ",", "0"}], "]"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxx10", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxx10", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxx10"}], "]"}]}], ",", "0"}], "]"}], "+", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxx11", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxx11", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxx11"}], "]"}]}], ",", "0"}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"XXXt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "t"}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "t"}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "t"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", 
          RowBox[{"T", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx000", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx001", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx010", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx100", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx011", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx101", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx110", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxxx111", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hxxx", "=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx000", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx000", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx000"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx001", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx001", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx001"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx010", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx010", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx010"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx100", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx100", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx100"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx011", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx011", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx011"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx101", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx101", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx101"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx110", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx110", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx110"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxxx111", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxxx111", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxxx111"}], "]"}]}], ",", "0"}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"XpXXt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"t", "+", "1"}]}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "t"}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "t"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", 
          RowBox[{"T", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx000", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx001", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx010", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx100", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx011", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx101", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx110", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxx111", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hxpxx", "=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx000", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx000", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx000"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx001", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx001", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx001"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx010", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx010", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx010"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx100", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx100", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx100"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx011", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx011", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx011"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx101", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx101", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx101"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx110", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx110", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx110"}], "]"}]}], ",", "0"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxx111", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxx111", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxx111"}], "]"}]}], ",", "0"}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"XpXXXt", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", 
             RowBox[{"t", "+", "1"}]}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "t"}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "t"}], "]"}], "]"}], ",", 
          RowBox[{"Xt", "[", 
           RowBox[{"[", 
            RowBox[{"3", ",", "t"}], "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", 
          RowBox[{"T", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0000", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0001", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0010", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0011", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0100", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0101", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0110", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx0111", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1000", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1001", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1010", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1011", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1100", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1101", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1110", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1", ",", "0"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pxpxxx1111", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"XpXXXt", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"T", "-", "1"}], ")"}]}], ")"}], "//", "N"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"hxpxxx", "=", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0000", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0000", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0000"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0001", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0001", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0001"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0010", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0010", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0010"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0011", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0011", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0011"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0100", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0100", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0100"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0101", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0101", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0101"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0110", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0110", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0110"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx0111", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx0111", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx0111"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1000", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1000", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1000"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1001", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1001", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1001"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1010", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1010", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1010"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1011", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1011", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1011"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1100", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1100", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1100"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1101", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1101", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1101"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1110", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1110", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1110"}], "]"}]}], ",", "0"}], "]"}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Pxpxxx1111", ">", "\[Epsilon]"}], ",", 
           RowBox[{"Pxpxxx1111", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"2", ",", "Pxpxxx1111"}], "]"}]}], ",", "0"}], "]"}]}], 
        ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"hxpxx", "+", "hxxx", "-", "hxx", "-", "hxpxxx"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.759170928056965*^9, 3.759170929892146*^9}, {
  3.759170979911116*^9, 3.7591710328812103`*^9}, {3.7591711760648537`*^9, 
  3.759171755644182*^9}, {3.759171790618037*^9, 3.7591720159830303`*^9}, {
  3.7591722560995083`*^9, 3.75917231046702*^9}, {3.7591723876415024`*^9, 
  3.7591724150462646`*^9}, {3.7591739117626753`*^9, 3.759173915442768*^9}, {
  3.7592579648071594`*^9, 
  3.7592579650382824`*^9}},ExpressionUUID->"96c6a44b-b7bf-442c-b057-\
7635e1ea9dfe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Shuffling for conditional transfer entropy analysis on binary time series Xt= \
{XTARGET,XSOURCE,XCOND}: Shuffle(Xt) - only XSOURCE is shuffled to preserve \
associations between XSOURCE and (XTARGET,COND) \
\>", "Subsection",
 CellChangeTimes->{{3.7591706236581173`*^9, 3.7591706405626183`*^9}, {
  3.759170712673134*^9, 3.759170728840203*^9}, {3.7591708149030867`*^9, 
  3.7591708236688375`*^9}, {3.759172696727439*^9, 3.7591727395091343`*^9}, {
  3.7591728383988075`*^9, 3.7591729248077745`*^9}, {3.7591737209974575`*^9, 
  3.759173761007147*^9}, {3.7591738039571695`*^9, 3.759173807666567*^9}, {
  3.759173886103095*^9, 3.7591738999054847`*^9}, {3.759174119238803*^9, 
  3.759174121216211*^9}, {3.7591742486421676`*^9, 3.759174322024428*^9}, {
  3.759174387154347*^9, 3.759174426476208*^9}, {3.7591744793907433`*^9, 
  3.759174479633402*^9}, {3.759257965256358*^9, 
  3.759257965427142*^9}},ExpressionUUID->"3e14c6c8-7042-4ad9-a6fa-\
6fb2cdf66f94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Shuffle", "[", "Xt_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "T", ",", "XTARGET", ",", "XSOURCE", ",", "XCOND", ",", "XCONDXTARGET", 
      ",", "Pos00XCONDXTARGET", ",", "Pos01XCONDXTARGET", ",", 
      "Pos10XCONDXTARGET", ",", "Pos11XCONDXTARGET", ",", 
      "XSOURCEPos00XCONDXTARGET", ",", "XSOURCEPos01XCONDXTARGET", ",", 
      "XSOURCEPos10XCONDXTARGET", ",", "XSOURCEPos11XCONDXTARGET", ",", 
      "XSOURCEShufflePos00XCONDXTARGET", ",", 
      "XSOURCEShufflePos01XCONDXTARGET", ",", 
      "XSOURCEShufflePos10XCONDXTARGET", ",", 
      "XSOURCEShufflePos11XCONDXTARGET", ",", "i00", ",", "i01", ",", "i10", 
      ",", "i11", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XTARGET", "=", 
      RowBox[{"Xt", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XSOURCE", "=", 
      RowBox[{"Xt", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XCOND", "=", 
      RowBox[{"Xt", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"T", "=", 
      RowBox[{"Length", "[", "XSOURCE", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XCONDXTARGET", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"XCOND", "[", 
           RowBox[{"[", "t", "]"}], "]"}], ",", 
          RowBox[{"XTARGET", "[", 
           RowBox[{"[", "t", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "1", ",", "T"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Pos00XCONDXTARGET", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"XCONDXTARGET", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pos01XCONDXTARGET", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"XCONDXTARGET", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pos10XCONDXTARGET", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"XCONDXTARGET", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Pos11XCONDXTARGET", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"XCONDXTARGET", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "]"}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEPos00XCONDXTARGET", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"XSOURCE", "[", 
         RowBox[{"[", 
          RowBox[{"Pos00XCONDXTARGET", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "Pos00XCONDXTARGET", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEPos01XCONDXTARGET", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"XSOURCE", "[", 
         RowBox[{"[", 
          RowBox[{"Pos01XCONDXTARGET", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "Pos01XCONDXTARGET", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEPos10XCONDXTARGET", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"XSOURCE", "[", 
         RowBox[{"[", 
          RowBox[{"Pos10XCONDXTARGET", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "Pos10XCONDXTARGET", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEPos11XCONDXTARGET", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"XSOURCE", "[", 
         RowBox[{"[", 
          RowBox[{"Pos11XCONDXTARGET", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "Pos11XCONDXTARGET", "]"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEShufflePos00XCONDXTARGET", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"XSOURCEPos00XCONDXTARGET", ",", 
        RowBox[{"Length", "[", "XSOURCEPos00XCONDXTARGET", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEShufflePos01XCONDXTARGET", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"XSOURCEPos01XCONDXTARGET", ",", 
        RowBox[{"Length", "[", "XSOURCEPos01XCONDXTARGET", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEShufflePos10XCONDXTARGET", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"XSOURCEPos10XCONDXTARGET", ",", 
        RowBox[{"Length", "[", "XSOURCEPos10XCONDXTARGET", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"XSOURCEShufflePos11XCONDXTARGET", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"XSOURCEPos11XCONDXTARGET", ",", 
        RowBox[{"Length", "[", "XSOURCEPos11XCONDXTARGET", "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"i00", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i01", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i10", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"i11", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<", 
        RowBox[{"T", "+", "1"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"Pos00XCONDXTARGET", ",", "i"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"XSOURCE", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"XSOURCEShufflePos00XCONDXTARGET", "[", 
            RowBox[{"[", "i00", "]"}], "]"}]}], ";", 
          RowBox[{"i00", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"Pos01XCONDXTARGET", ",", "i"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"XSOURCE", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"XSOURCEShufflePos01XCONDXTARGET", "[", 
            RowBox[{"[", "i01", "]"}], "]"}]}], ";", 
          RowBox[{"i01", "+=", "1"}]}], ",", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"Pos10XCONDXTARGET", ",", "i"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"XSOURCE", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"XSOURCEShufflePos10XCONDXTARGET", "[", 
            RowBox[{"[", "i10", "]"}], "]"}]}], ";", 
          RowBox[{"i10", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"Pos11XCONDXTARGET", ",", "i"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"XSOURCE", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"XSOURCEShufflePos11XCONDXTARGET", "[", 
            RowBox[{"[", "i11", "]"}], "]"}]}], ";", 
          RowBox[{"i11", "+=", "1"}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"XTARGET", ",", "XSOURCE", ",", "XCOND"}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7591729322514067`*^9, 3.759172961748714*^9}, {
   3.759173009120516*^9, 3.7591731734469595`*^9}, {3.7591732968342533`*^9, 
   3.7591734081134143`*^9}, {3.759173442158036*^9, 3.7591735258711524`*^9}, {
   3.759173668157941*^9, 3.7591736905690603`*^9}, {3.759173934673224*^9, 
   3.759173953726081*^9}, {3.7591740015099697`*^9, 3.7591740103213234`*^9}, {
   3.7591740782390594`*^9, 3.759174108341488*^9}, {3.75917414278548*^9, 
   3.7591741622021503`*^9}, 3.7591751857558885`*^9, {3.759257965985755*^9, 
   3.759257977461874*^9}},ExpressionUUID->"ba035297-b178-41cf-94e0-\
49ee4e4cabe3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
NS surrogate values of conditional transfer entropy on binary time series \
XSOURCE->XTARGET/XCOND: SurrCondTE[XTARGET,XSOURCE,XCOND,NS] \
\>", "Subsection",
 CellChangeTimes->{{3.7591706236581173`*^9, 3.7591706405626183`*^9}, {
  3.759170712673134*^9, 3.759170728840203*^9}, {3.7591708149030867`*^9, 
  3.7591708236688375`*^9}, {3.759172696727439*^9, 3.7591727102975063`*^9}, {
  3.7591744627761126`*^9, 3.759174490061997*^9}, {3.759174608646963*^9, 
  3.7591746137286863`*^9}, {3.7591749243923087`*^9, 3.7591749553964667`*^9}, {
  3.7591754653021035`*^9, 3.7591755107929354`*^9}, {3.759257978192374*^9, 
  3.759257978428322*^9}},ExpressionUUID->"9412d09f-ad0d-4a41-9bc5-\
84dc83450539"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SurrCondTE", "[", 
   RowBox[{"XTARGET_", ",", "XSOURCE_", ",", "XCOND_", ",", "NS_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Xt", ",", "k", ",", "XtShuffle", ",", "Aux"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Xt", "=", 
      RowBox[{"{", 
       RowBox[{"XTARGET", ",", "XSOURCE", ",", "XCOND"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Aux", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "NS"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "<", 
        RowBox[{"NS", "+", "1"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"XtShuffle", "=", 
         RowBox[{"Shuffle", "[", "Xt", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Aux", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "=", 
         RowBox[{"CondTE", "[", 
          RowBox[{
           RowBox[{"XtShuffle", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"XtShuffle", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"XtShuffle", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "Aux"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7591745251270137`*^9, 3.7591745345810785`*^9}, {
   3.7591746164377966`*^9, 3.7591746203455734`*^9}, {3.759174680102519*^9, 
   3.7591747952034216`*^9}, {3.7591749591885605`*^9, 3.759175060914166*^9}, {
   3.75917514083051*^9, 3.75917514293758*^9}, {3.7591752279266624`*^9, 
   3.7591752289282165`*^9}, 3.759175478107607*^9, {3.759175513394484*^9, 
   3.7591755248915634`*^9}, {3.759257978614251*^9, 
   3.7592579791552706`*^9}},ExpressionUUID->"030e47fc-297b-494b-a525-\
22af7dd7a261"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Number of surrogates to be used for the analysis (50,000 in the paper)\
\>", "Section",
 CellChangeTimes->{{3.7385851589034653`*^9, 3.7385851655524387`*^9}, {
  3.7401550744233236`*^9, 3.740155075468424*^9}, {3.759175722910432*^9, 
  3.7591757374843535`*^9}, {3.75925809400378*^9, 
  3.759258099540131*^9}},ExpressionUUID->"18ec27f1-ba82-47d2-be3e-\
6957c0d2b9be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NSURR", "=", "100"}], ";"}]], "Input",
 CellChangeTimes->{{3.7385851685522738`*^9, 3.7385852097382593`*^9}, {
   3.7385852845182714`*^9, 3.7385852848218546`*^9}, 3.740155087200959*^9, {
   3.74016054512167*^9, 3.7401605456802683`*^9}, {3.7401632669023695`*^9, 
   3.740163270993786*^9}, 3.740165418712618*^9, 3.740167707469198*^9, 
   3.740169697693088*^9, {3.740227202164073*^9, 3.740227202304742*^9}, {
   3.758472007518751*^9, 3.7584720079517508`*^9}, 3.758575535529439*^9, 
   3.758583284878624*^9, {3.7586147161627507`*^9, 3.758614716332751*^9}, {
   3.7587253798561687`*^9, 3.758725381066021*^9}, 3.758730231190322*^9, {
   3.7587317300717545`*^9, 3.7587317334130583`*^9}, {3.758732233894083*^9, 
   3.758732234495845*^9}, {3.7587394993400316`*^9, 3.758739510999523*^9}, 
   3.7587601052403564`*^9, {3.7587628340848737`*^9, 3.758762836059452*^9}, {
   3.7591757406670322`*^9, 3.7591757410761623`*^9}, {3.7591757797548323`*^9, 
   3.759175780227785*^9}, 3.759176390702735*^9, 3.7591768392811413`*^9, {
   3.759177786061348*^9, 3.7591777864542646`*^9}, 3.7591781354493723`*^9, 
   3.7591799396326804`*^9},ExpressionUUID->"431155a5-4fa9-440e-8306-\
073a62c1eaf5"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Conditional transfer entropies MO->BC/MS for all the states  \
\>", "Section",
 CellChangeTimes->{{3.740155103359545*^9, 3.7401551438488693`*^9}, {
  3.759175749892116*^9, 3.759175940956641*^9}, {3.759178218817962*^9, 
  3.759178219536046*^9}, {3.7591800624783936`*^9, 
  3.7591800763419094`*^9}},ExpressionUUID->"724dece1-9da8-4647-b725-\
5e622197cb50"],

Cell[CellGroupData[{

Cell["Computation of all the conditional transfer entropies", "Subsection",
 CellChangeTimes->{{3.7384717505918083`*^9, 3.7384717890165963`*^9}, {
  3.7584646729787507`*^9, 3.758464687086751*^9}, {3.7587254414012938`*^9, 
  3.758725454505702*^9}},ExpressionUUID->"cfb45207-7f7a-4e71-a618-\
47823dc78a25"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CondTEResults", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"CondTE", "[", 
      RowBox[{
       RowBox[{"XBC", "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", "XMO", ",", "XMS"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.759180016534685*^9, 
  3.7591800429547496`*^9}},ExpressionUUID->"34f9dec8-945f-40f6-88d1-\
313e230ecba9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Surrogate time series analysis", "Subsection",
 CellChangeTimes->{{3.7384717505918083`*^9, 3.7384717890165963`*^9}, {
   3.7584646729787507`*^9, 3.758464687086751*^9}, 
   3.7591803799393454`*^9},ExpressionUUID->"2768a7a8-e5f3-4536-a893-\
f8b0c3afcd9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SurrCondTEResults", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"SurrCondTE", "[", 
       RowBox[{
        RowBox[{"XBC", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", "XMO", ",", "XMS", ",", 
        "NSURR"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7591762519785*^9, 3.7591762629754047`*^9}, {
  3.759176329605148*^9, 3.759176370191351*^9}, {3.7591764284873266`*^9, 
  3.7591764420742264`*^9}, {3.7591804143830447`*^9, 3.759180449878792*^9}, {
  3.7591805048903627`*^9, 
  3.7591805123372197`*^9}},ExpressionUUID->"b8780916-3362-4da3-9c25-\
06a219be51c5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Statistical comparisons with plots of pertinent histograms", \
"Subsection",
 CellChangeTimes->{{3.738472324299641*^9, 3.7384723324296837`*^9}, {
  3.7401642053129396`*^9, 3.740164217928378*^9}, {3.759178280522336*^9, 
  3.7591782956073484`*^9}},ExpressionUUID->"67f77555-145d-4636-b117-\
06ab41e46928"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pvaluetab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ninetyfivetab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{
        RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.758730409831341*^9, 3.758730468206795*^9}, {
  3.758762099907024*^9, 
  3.758762106202902*^9}},ExpressionUUID->"cb91a9c7-daab-4d0d-b800-\
c1895acd6bae"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "1"}], ",", 
   RowBox[{"j", "<", 
    RowBox[{
     RowBox[{
      RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CountAux", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"SurrCondTEResults", "[", 
           RowBox[{"[", 
            RowBox[{"k", ",", "j"}], "]"}], "]"}], ">", 
          RowBox[{"CondTEResults", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}], ",", "1", ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "NSURR"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"CountAuxSum", "=", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"CountAux", "[", 
        RowBox[{"[", "k", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "NSURR"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pvaluetab", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"CountAuxSum", "+", "1"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"NSURR", "+", "1"}], ")"}]}], "//", "N"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ninetyfivetab", "[", 
      RowBox[{"[", "j", "]"}], "]"}], "=", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "SurrCondTEResults", "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], ",", "0.95"}], "]"}]}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7587621444065657`*^9, 3.7587622269500237`*^9}, {
  3.758762393914135*^9, 3.7587623950648265`*^9}, {3.7591806708959064`*^9, 
  3.7591807661067133`*^9}, {3.7591807973813877`*^9, 
  3.759180798183815*^9}},ExpressionUUID->"5477b4be-5cc8-4a68-afb8-\
0b9fd5d61490"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Final set of results reported in the paper in tabular form and exporting TE \
and p values\
\>", "Section",
 CellChangeTimes->{{3.759178241910781*^9, 3.7591782605267177`*^9}, {
  3.7591805682889977`*^9, 
  3.759180577927142*^9}},ExpressionUUID->"88fd243c-d09e-4795-9400-\
9df7074e8dfe"],

Cell[BoxData[
 RowBox[{"TableForm", "[", "\[IndentingNewLine]", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
      "\"\<State\>\"", ",", "\"\<Conditional TE\>\"", ",", "\"\<95%\>\"", 
       ",", "\"\<p\>\"", ",", "\"\<Significance\>\""}], "}"}], "}"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StateNames", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"CondTEResults", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"Ninetyfivetab", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"pvaluetab", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"CondTEResults", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ">", 
           RowBox[{"Ninetyfivetab", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", "\"\<*\>\"", ",", 
          "\"\<\>\""}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{
         RowBox[{"Dimensions", "[", "BC", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7591801613693485`*^9, 3.759180246448779*^9}, {
  3.759180287640025*^9, 3.759180345604826*^9}, {3.7591809337447753`*^9, 
  3.759180975380477*^9}, {3.7591810067745223`*^9, 3.759181066404397*^9}, {
  3.759181112413172*^9, 3.7591811227215343`*^9}, {3.7592582920775785`*^9, 
  3.7592582936510696`*^9}},ExpressionUUID->"e4fce2f3-7a9c-478b-9b89-\
19dff707679b"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<TEvaluesstates.txt\>\"", ",", "CondTEResults"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.759180834471105*^9},ExpressionUUID->"ab63746e-9400-4c54-893f-\
314273fbd5a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<pvaluesstates.txt\>\"", ",", "pvaluetab"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.758762396182309*^9, 3.7587624490128207`*^9}, {
  3.7587625097144003`*^9, 
  3.7587625108291783`*^9}},ExpressionUUID->"98748c49-1083-43ed-bd56-\
1650d5134e92"]
}, Closed]]
}, Open  ]]
},
CellGrouping->Manual,
WindowSize->{1280, 637},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (April 18, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 526, 10, 342, "Title", "ExpressionUUID" -> \
"3f5bbd5b-b8c3-4282-9f4e-cdbe883e1d21"],
Cell[CellGroupData[{
Cell[1131, 36, 300, 5, 107, "Section", "ExpressionUUID" -> \
"4965ea07-7681-400f-9379-19a57f510140"],
Cell[CellGroupData[{
Cell[1456, 45, 220, 4, 243, "Subsection", "ExpressionUUID" -> \
"d371701f-e533-4ebd-b7ab-85f7e6e570ed"],
Cell[1679, 51, 661, 11, 154, "Input", "ExpressionUUID" -> \
"76445fae-9b9d-4c78-b061-9ff22683bbf7"]
}, Closed]],
Cell[CellGroupData[{
Cell[2377, 67, 766, 13, 487, "Subsection", "ExpressionUUID" -> \
"c939f107-56f9-4597-94a4-72714d5088ef"],
Cell[3146, 82, 904, 18, 1296, "Input", "ExpressionUUID" -> \
"f41f98e9-d6e0-4f4e-9646-fda4d5fa617a"],
Cell[4053, 102, 2468, 63, 2281, "Input", "ExpressionUUID" -> \
"f503e116-bb52-4603-99df-9a3acf3dcc94"]
}, Closed]],
Cell[CellGroupData[{
Cell[6558, 170, 253, 5, 195, "Subsection", "ExpressionUUID" -> \
"5f0f4444-528b-483e-8aab-bd162813d19f"],
Cell[6814, 177, 2583, 75, 549, "Input", "ExpressionUUID" -> \
"1e276d92-8ae3-49b0-859a-397b93999c3f"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[9446, 258, 177, 3, 84, "Section", "ExpressionUUID" -> \
"8621902e-017c-40f8-a2c0-c8c8503e8886"],
Cell[CellGroupData[{
Cell[9648, 265, 571, 10, 1318, "Subsection", "ExpressionUUID" -> \
"5a15c344-7b56-436b-b89f-091ba4afdd48"],
Cell[10222, 277, 29427, 795, 30921, "Input", "ExpressionUUID" -> \
"96c6a44b-b7bf-442c-b057-7635e1ea9dfe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39686, 1077, 962, 15, 1804, "Subsection", "ExpressionUUID" -> \
"3e14c6c8-7042-4ad9-a6fa-6fb2cdf66f94"],
Cell[40651, 1094, 8459, 194, 17376, "Input", "ExpressionUUID" -> \
"ba035297-b178-41cf-94e0-49ee4e4cabe3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49147, 1293, 698, 11, 1318, "Subsection", "ExpressionUUID" -> \
"9412d09f-ad0d-4a41-9bc5-84dc83450539"],
Cell[49848, 1306, 2087, 50, 3829, "Input", "ExpressionUUID" -> \
"030e47fc-297b-494b-a525-22af7dd7a261"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[51984, 1362, 374, 7, 147, "Section", "ExpressionUUID" -> \
"18ec27f1-ba82-47d2-be3e-6957c0d2b9be"],
Cell[52361, 1371, 1201, 18, 154, "Input", "ExpressionUUID" -> \
"431155a5-4fa9-440e-8306-073a62c1eaf5"]
}, Closed]],
Cell[CellGroupData[{
Cell[53599, 1394, 364, 7, 84, "Section", "ExpressionUUID" -> \
"724dece1-9da8-4647-b725-5e622197cb50"],
Cell[CellGroupData[{
Cell[53988, 1405, 304, 4, 162, "Subsection", "ExpressionUUID" -> \
"cfb45207-7f7a-4e71-a618-47823dc78a25"],
Cell[54295, 1411, 575, 16, 154, "Input", "ExpressionUUID" -> \
"34f9dec8-945f-40f6-88d1-313e230ecba9"]
}, Closed]],
Cell[CellGroupData[{
Cell[54907, 1432, 259, 4, 130, "Subsection", "ExpressionUUID" -> \
"2768a7a8-e5f3-4536-a893-f8b0c3afcd9c"],
Cell[55169, 1438, 858, 22, 256, "Input", "ExpressionUUID" -> \
"b8780916-3362-4da3-9c25-06a219be51c5"]
}, Closed]],
Cell[CellGroupData[{
Cell[56064, 1465, 309, 5, 130, "Subsection", "ExpressionUUID" -> \
"67f77555-145d-4636-b117-06ab41e46928"],
Cell[56376, 1472, 789, 23, 256, "Input", "ExpressionUUID" -> \
"cb91a9c7-daab-4d0d-b800-c1895acd6bae"],
Cell[57168, 1497, 2007, 56, 648, "Input", "ExpressionUUID" -> \
"5477b4be-5cc8-4a68-afb8-0b9fd5d61490"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[59224, 1559, 296, 7, 147, "Section", "ExpressionUUID" -> \
"88fd243c-d09e-4795-9400-9df7074e8dfe"],
Cell[59523, 1568, 1648, 40, 244, "Input", "ExpressionUUID" -> \
"e4fce2f3-7a9c-478b-9b89-19dff707679b"],
Cell[61174, 1610, 224, 6, 69, "Input", "ExpressionUUID" -> \
"ab63746e-9400-4c54-893f-314273fbd5a3"],
Cell[61401, 1618, 317, 8, 69, "Input", "ExpressionUUID" -> \
"98748c49-1083-43ed-bd56-1650d5134e92"]
}, Closed]]
}, Open  ]]
}
]
*)

